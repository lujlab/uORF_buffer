# uORF_buffer

This repository stores the scripts used for simulation of the translation process of an mRNA molecule. The model used here is based on Andreev et al.'s ICIER model [(ref)](https://elifesciences.org/articles/32563), which is distributed under GPLv3 licence at the following address: [https://github.com/maximarnold/uORF_TASEP_ICIER](https://github.com/maximarnold/uORF_TASEP_ICIER). The original model is implemented in MATLAB, and we adpated it using python.


## Usage of the scripts
The core components of the model is integrated into the file [ICIER_extended_v8.py](https://github.com/lujlab/uORF_buffer/blob/main/ICIER_extended_v8.py). The function `Sim_main(condition_set)` executes a single run of simulation. Based on the previous one, the function `Sim_multi_condition(condition_list, outfile_path)` executes multiple runs of simulation.<br/>
`Sim_main(condition_set)` takes a dictionary as the only input, and the requisite items of the dictionary can be found at the begining of [ICIER_extended_v8.py](https://github.com/lujlab/uORF_buffer/blob/main/ICIER_extended_v8.py), in the `default_condition_set`. Such a dictionary specifies all parameters necessary for a single run of simulation.<br/>
`Sim_multi_condition(condition_list, outfile_path)` takes two input objects, where `condition_list` is a list of dictionaries that fit `Sim_main()`, and `outfile_path` is the path of a text file that you want to write the results into.<br/>
For a batch of simulation, you need to first creat a list of dictionaries, then utilize `Sim_multi_condition(condition_list, outfile_path)`. This can be done with a separate script, let's take [1000Lambda_runif__11P_s2p_u__11P_s2p_m__v8_downstream_dissociation.py](https://github.com/lujlab/uORF_buffer/blob/main/1000Lambda_runif__11P_s2p_u__11P_s2p_m__v8_downstream_dissociation.py) as an example. In this script, we simulated translation processes under 1000 values of Lambda (generated by a random generator of uniform distribution, stored in the file [Lambda_input/num_runif.txt](https://github.com/lujlab/uORF_buffer/blob/main/Lambda_input/num_runif.txt)), 11 values of P_s2p_u (0, 0.1, 0.2,..., 1) and 11 values of P_s2p_m (0, 0.1, 0.2, ..., 1), thus there are a total of 1000\*11\*11 = 121000 runs of simulation under 121000 different kinds of conditions.<br/>
We first create a list containing 121000 dictionaries corresponding to the 121000 kinds of conditions we want to simulate, like this:
```python
from ICIER_extended_v8 import *

condition_list = []

with open('Lambda_input/num_runif.txt', 'r') as r_in_file:
    r_in_lines = r_in_file.readlines()

for i in [k / 10 for k in range(0, 11)]:
    for j in [k / 10 for k in range(0, 11)]:
        for k in r_in_lines:
            tmp = default_condition_set.copy()
            tmp['Lambda'] = float(k.split('\t')[1])
            tmp['P_s2p_u'] = i
            tmp['P_s2p_m'] = j
            condition_list.append(tmp)
```
Then we use the `Sim_multi_condition(condition_list, outfile_path)` function and specify the output file path here:
```python
Sim_multi_condition(condition_list, 'sim_result/1000Lambda_runif__11P_s2p_u__11P_s2p_m__v8_downstream_dissociation.txt')
```
Run this script, and we will get the result file at sim_result/1000Lambda_runif__11P_s2p_u__11P_s2p_m__v8_downstream_dissociation.txt, which contains a header line and then 121000 lines of results. Note that the output will also be printed to standard output in real time, and you can either discard it or use it to monitor the progress, etc.

## Colums in the result file
The result file is a tab-delimited text file with 40 columns, the first column is the ID of each run, the 2nd to 25th lines (Ls to TTIme) are the parameters of condition that are set in the input dictionaries, and the 26th to 40th lines (SRNA_started to SRNA_kicked_downstream_m) are the actual output values. Here the description of all the columns are listed. **Note that some parameters and values have different symbols in scripts and in the article, while they are actually the same variable.**
|Column name (symbol in scipts)| Symbol in article|Description|
|---|---|---|
|sim_ID||The id of each run. Generated according to system time.|
|Ls||Length of a 40S ribosome.|
|Le||Length of an 80S ribosome.|
|Len_a||Length before uATG.|
|Len_u||Length between uATG and uSTOP, both ends included.|
|Len_b||
|Len_m||
|Len_c||
|Lambda|*R<sub>in</sub>*|Probability of 40S loading in a single action.|
|P_delay_au
|P_delay_ub
|P_delay_bm
|P_delay_mc
|P_s2p_u
|P_p2s_u
|P_s2p_m
|P_p2s_m
|P_smove
|P_pmove_u
|P_pmove_m
|P_sdeath
|P_edeath
|P_clear_up
|P_clear_down
|TTime
|SRNA_started
|SRNA_passed_au
|PRNA_started_u
|PRNA_dropped_u
|PRNA_finished_u
|SRNA_passed_bm
|PRNA_started_m
|PRNA_dropped_m
|PRNA_finished_m
|SRNA_dropped
|SRNA_end
|SRNA_kicked_upstream_u
|SRNA_kicked_downstream_u
|SRNA_kicked_upstream_m
|SRNA_kicked_downstream_m
